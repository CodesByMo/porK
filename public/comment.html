<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Pork Comments</title>

    <link rel="stylesheet" href="styles.css">
    <script src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/css/bootstrap.min.css" />
    <!-- Font Awesome CSS Icons (For cool glyphicons) -->
    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />-->
</head>

<body>
    <div class="container" id="bg">
        <div class="container">
            <div class="row">
                <div class="jumbotron topBox m-3 p-2 text-secondary col col-md-6 col-lg-12 text-center ">
                    <header>
                        <!--The line below should be changed to include logo and tag line-->
                        <h1>Welcome to PorK!</h1>
                    </header>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                <div class="card mainBox m-3 p-2 col" id="profile">
                    <div class="card-header m-1 text-secondary font-weight-bold">
                        <!--Optional text forcard header displayed below including the current logged in user's name-->
                        <h1>Hi <span id="name"></span>, Here's the Question you selected.</h1>
                    </div>
                    <div id="questionHere" class="card-body">
                        <!--This section should display the post the user would
                            like to see the comments on-->
                    </div>
                </div>
            </div>
        </div>

        <div class="container">

                <div class="row">
                    <div class="card mainBox m-3 p-2 col" id="profile">
                        <div class="card-header m-1 text-secondary font-weight-bold">
                            <!--Optional text for card header displayed below-->
                            <h1> Here's the comments on the above Question you selected.</h1>
                        </div>
                        <div id="allComments" class="card-body">
                            <!--This section should display the comments all users have 

                                have posted in regards to the above question-->
                    </div>
                </div>
            </div>
        </div>
    </div>


        <div class="container">
            <div class="row">
                <div class="card mainBox m-3 p-2 col col-lg-12">
                    <div class="card-header m-3 p-2">

                        <label for="comment">comment</label>
                        <input id="userInput" type="text" name="comment">
                        <button id="postComment">Submit</button>
                        
                    </div>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="row">
                    <div class="card mainBox m-3 p-2 col col-lg-12">
                        <div class="card-header m-3 p-2">
                            <!--If the first button below doesnt work try changing the reference 

                                link on the second commented out button to re direct user back to the home page-->
                        <button id="toProfile">Click me to return homepage</button>
                        <!-- <a href="/login">Go to login</a> -->


                            <!--Also below is a button to redirect the users to the All Questions Main view-->
                            
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--Log out button below-->

    <div class="container">
        <button id="logout">Logout</button>
    </div>


    </div>

<script>

var num = window.location.pathname.split("/").reverse();

$.get("/api/post/"+num, function(res){
    console.log(res)
    $("#questionHere").text(res.question)
})

$.get("/all/comments/"+num, function(res){
    for(i = 0; i < res.length; i++){
        var cp = $("<p>").text(res[i].comment + " From " + res[i].User.nameX );
        $("#allComments").append(cp);
    }
    console.log(res);
})

$("#toProfile").on("click", function(){
    window.location.href = "/";
})

$("#postComment").on("click", function(){
    var send = {comment: $("#userInput").val()};
    $.post("/comment/post/"+num, send, function(res){

    })
})

</script>
</body>
</html>